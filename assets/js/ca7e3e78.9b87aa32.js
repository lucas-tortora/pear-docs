"use strict";(globalThis.webpackChunkpear_docs_docusarus=globalThis.webpackChunkpear_docs_docusarus||[]).push([[150],{4485:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"references/bare/usage","title":"Usage","description":"Install Bare","source":"@site/docs/references/bare/usage.md","sourceDirName":"references/bare","slug":"/references/bare/usage","permalink":"/pear-docs/references/bare/usage","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/references/bare/usage.md","tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Troubleshooting","permalink":"/pear-docs/references/bare/troubleshooting"},"next":{"title":"Building Blocks Overview","permalink":"/pear-docs/references/building-blocks/overview"}}');var r=s(4848),a=s(8453);const t={},l="Usage",o={},d=[{value:"Install Bare",id:"install-bare",level:2},{value:"Basic Usage",id:"basic-usage",level:2},{value:"API",id:"api",level:2},{value:"Modules",id:"modules",level:3},{value:"Embedding",id:"embedding",level:3},{value:"Suspension",id:"suspension",level:3},{value:"Building",id:"building",level:2},{value:"Linking",id:"linking",level:3},{value:"Options",id:"options",level:3}];function c(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"usage",children:"Usage"})}),"\n",(0,r.jsx)(n.h2,{id:"install-bare",children:"Install Bare"}),"\n",(0,r.jsx)(n.p,{children:"You can install Bare using the following command:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"npm i -g bare\n"})}),"\n",(0,r.jsx)(n.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:"bare [flags] <filename> [...args]\n\nEvaluate a script or start a REPL session if no script is provided.\n\nArguments:\n  <filename>            The name of a script to evaluate\n  [...args]             Additional arguments made available to the script\n\nFlags:\n  --version|-v          Print the Bare version\n  --eval|-e <script>    Evaluate an inline script\n  --print|-p <script>   Evaluate an inline script and print the result\n  --inspect             Activate the inspector\n  --help|-h             Show help\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The specified ",(0,r.jsx)(n.code,{children:"<script>"})," or ",(0,r.jsx)(n.code,{children:"<filename>"})," is run using ",(0,r.jsx)(n.code,{children:"Module.load()"}),". For more information on the module system and the supported formats, see ",(0,r.jsx)(n.a,{href:"https://github.com/holepunchto/bare-module",children:"BareModule"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,r.jsxs)(n.p,{children:["Bare makes it easy to craft applications that can run effectively across a broad spectrum of devices. To get started, find the Bare API specs ",(0,r.jsx)(n.a,{href:"/pear-docs/references/bare/api",children:"here"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"modules",children:"Modules"}),"\n",(0,r.jsxs)(n.p,{children:["Bare provides no standard library beyond the core JavaScript API available through the ",(0,r.jsx)(n.code,{children:"Bare"})," namespace. Instead, there is a comprehensive collection of external modules built specifically for Bare, see ",(0,r.jsx)(n.a,{href:"/pear-docs/references/bare/bare-modules",children:"Bare Modules"})]}),"\n",(0,r.jsx)(n.h3,{id:"embedding",children:"Embedding"}),"\n",(0,r.jsxs)(n.p,{children:["Bare can easily be embedded using the C API defined in ",(0,r.jsx)(n.a,{href:"https://github.com/holepunchto/bare/blob/main/include/bare.h",children:(0,r.jsx)(n.code,{children:"include/bare.h"})}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-c",children:"#include <bare.h>\n#include <uv.h>\n\nbare_t *bare;\nbare_setup(uv_default_loop(), platform, &env /* Optional */, argc, argv, options, &bare);\n\nbare_load(bare, filename, source, &module /* Optional */);\n\nbare_run(bare);\n\nint exit_code;\nbare_teardown(bare, &exit_code);\n"})}),"\n",(0,r.jsxs)(n.p,{children:["If ",(0,r.jsx)(n.code,{children:"source"})," is ",(0,r.jsx)(n.code,{children:"NULL"}),", the contents of ",(0,r.jsx)(n.code,{children:"filename"})," will instead be read at runtime. For examples of how to embed Bare on mobile platforms, see ",(0,r.jsx)(n.a,{href:"https://github.com/holepunchto/bare-android",children:"Bare Android"})," and ",(0,r.jsx)(n.a,{href:"https://github.com/holepunchto/bare-ios",children:"Bare iOS"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"suspension",children:"Suspension"}),"\n",(0,r.jsxs)(n.p,{children:["Bare provides a mechanism for implementing process suspension, which is needed for platforms with strict application lifecycle constraints, such as mobile platforms. When suspended, a ",(0,r.jsx)(n.code,{children:"suspend"})," event will be emitted on the ",(0,r.jsx)(n.code,{children:"Bare"})," namespace. Then, when the loop has no work left and would otherwise exit, an ",(0,r.jsx)(n.code,{children:"idle"})," event will be emitted and the loop blocked, keeping it from exiting. When the process is later resumed, a ",(0,r.jsx)(n.code,{children:"resume"})," event will be emitted and the loop unblocked, allowing it to exit when no work is left."]}),"\n",(0,r.jsxs)(n.p,{children:["The suspension API is available through ",(0,r.jsx)(n.code,{children:"bare_suspend()"})," and ",(0,r.jsx)(n.code,{children:"bare_resume()"})," from C and ",(0,r.jsx)(n.code,{children:"Bare.suspend()"})," and ",(0,r.jsx)(n.code,{children:"Bare.resume()"})," from JavaScript."]}),"\n",(0,r.jsx)(n.h2,{id:"building",children:"Building"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/holepunchto/bare-make",children:(0,r.jsx)(n.code,{children:"BareMake"})})," is used for compiling Bare. Start by installing the tool globally:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:"npm i -g bare-make\n"})}),"\n",(0,r.jsx)(n.p,{children:"Next, install the required build and runtime dependencies:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:"npm i\n"})}),"\n",(0,r.jsx)(n.p,{children:"Then, generate the build system:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:"bare-make generate\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This only has to be run once per repository checkout. When updating ",(0,r.jsx)(n.code,{children:"bare-make"})," or your compiler toolchain it might also be necessary to regenerate the build system. To do so, run the command again with the ",(0,r.jsx)(n.code,{children:"--no-cache"})," flag set to disregard the existing build system cache:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:"bare-make generate --no-cache\n"})}),"\n",(0,r.jsx)(n.p,{children:"With a build system generated, Bare can be compiled:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:"bare-make build\n"})}),"\n",(0,r.jsxs)(n.p,{children:["When completed, the ",(0,r.jsx)(n.code,{children:"bare(.exe)"})," binary will be available in the ",(0,r.jsx)(n.code,{children:"build/bin"})," directory and the ",(0,r.jsx)(n.code,{children:"libbare.(a|lib)"})," and ",(0,r.jsx)(n.code,{children:"(lib)bare.(dylib|dll|lib)"})," libraries will be available in the root of the ",(0,r.jsx)(n.code,{children:"build"})," directory."]}),"\n",(0,r.jsx)(n.h3,{id:"linking",children:"Linking"}),"\n",(0,r.jsxs)(n.p,{children:["When linking against the static ",(0,r.jsx)(n.code,{children:"libbare.(a|lib)"})," library, make sure to use whole archive linking as Bare relies on constructor functions for registering native addons. Without whole archive linking, the linker will remove the constructor functions as they aren't referenced by anything."]}),"\n",(0,r.jsx)(n.h3,{id:"options",children:"Options"}),"\n",(0,r.jsxs)(n.p,{children:["Bare provides a few compile options that can be configured to customize various aspects of the runtime. Compile options may be set by passing the ",(0,r.jsx)(n.code,{children:"--define option=value"})," flag to the ",(0,r.jsx)(n.code,{children:"bare-make generate"})," command when generating the build system."]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["[!WARNING]",(0,r.jsx)(n.br,{}),"\n","The compile options are not covered by semantic versioning and are subject to change without warning."]}),"\n"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Option"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Default"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"BARE_ENGINE"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"github:holepunchto/libjs"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"The JavaScript engine to use"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"BARE_PREBUILDS"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"ON"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Enable prebuilds for supported third-party dependencies"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(6540);const r={},a=i.createContext(r);function t(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);