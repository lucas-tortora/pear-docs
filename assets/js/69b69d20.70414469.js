"use strict";(globalThis.webpackChunkpear_docs_docusarus=globalThis.webpackChunkpear_docs_docusarus||[]).push([[2373],{3231:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>t,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"references/helpers/mirrordrive","title":"MirrorDrive","description":"Mirrors a Hyperdrive or a LocalDrive into another one.","source":"@site/docs/references/helpers/mirrordrive.md","sourceDirName":"references/helpers","slug":"/references/helpers/mirrordrive","permalink":"/pear-docs/references/helpers/mirrordrive","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/references/helpers/mirrordrive.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Localdrive","permalink":"/pear-docs/references/helpers/localdrive"},"next":{"title":"Protomux","permalink":"/pear-docs/references/helpers/protomux"}}');var i=n(4848),d=n(8453);const c={},o="MirrorDrive",t={},l=[{value:"Installation",id:"installation",level:3},{value:"Basic usage",id:"basic-usage",level:3},{value:"API",id:"api",level:3},{value:"<strong><code>const mirror = new MirrorDrive(src, dst, [options])</code></strong>",id:"const-mirror--new-mirrordrivesrc-dst-options",level:4},{value:"<strong><code>mirror.count</code></strong>",id:"mirrorcount",level:4},{value:"<strong><code>await mirror.done()</code></strong>",id:"await-mirrordone",level:4}];function a(e){const r={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"mirrordrive",children:"MirrorDrive"})}),"\n",(0,i.jsxs)(r.p,{children:["Mirrors a ",(0,i.jsx)(r.a,{href:"/pear-docs/references/building-blocks/hyperdrive",children:(0,i.jsx)(r.code,{children:"Hyperdrive"})})," or a ",(0,i.jsx)(r.a,{href:"/pear-docs/references/helpers/localdrive",children:(0,i.jsx)(r.code,{children:"LocalDrive"})})," into another one."]}),"\n",(0,i.jsxs)(r.blockquote,{children:["\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.a,{href:"https://github.com/holepunchto/mirror-drive",children:"GitHub (Mirrordrive)"})}),"\n"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"/pear-docs/references/helpers/mirrordrive#installation",children:"Installation"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"/pear-docs/references/helpers/mirrordrive#basic-usage",children:"Basic usage"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"/pear-docs/references/helpers/mirrordrive#api",children:"API"})}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"installation",children:"Installation"}),"\n",(0,i.jsxs)(r.p,{children:["Install with ",(0,i.jsx)(r.a,{href:"https://www.npmjs.com/",children:"npm"}),":"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"npm install mirror-drive\n"})}),"\n",(0,i.jsx)(r.h3,{id:"basic-usage",children:"Basic usage"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",children:"import MirrorDrive from 'mirror-drive'\n\nconst src = new Localdrive('./src')\nconst dst = new Hyperdrive(store)\n\nconst mirror = new MirrorDrive(src, dst)\nconsole.log(mirror.count) // => { files: 0, add: 0, remove: 0, change: 0 }\n\nfor await (const diff of mirror) {\n  console.log(diff) /* {\n    op: 'add',\n    key: '/new-file.txt',\n    bytesRemoved: 0,\n    bytesAdded: 4\n  }*/\n}\n\nconsole.log(mirror.count) // => { files: 1, add: 1, remove: 0, change: 0 }\n"})}),"\n",(0,i.jsx)(r.h3,{id:"api",children:"API"}),"\n",(0,i.jsx)(r.h4,{id:"const-mirror--new-mirrordrivesrc-dst-options",children:(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"const mirror = new MirrorDrive(src, dst, [options])"})})}),"\n",(0,i.jsxs)(r.p,{children:["Creates a mirror instance to move ",(0,i.jsx)(r.code,{children:"src"})," drive into ",(0,i.jsx)(r.code,{children:"dst"})," drive."]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"options"})," include:"]}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Property"}),(0,i.jsx)(r.th,{children:"Type"}),(0,i.jsx)(r.th,{children:"Default"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"prefix"})})}),(0,i.jsx)(r.td,{children:"String"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"'/'"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"dryRun"})})}),(0,i.jsx)(r.td,{children:"Boolean"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"false"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"prune"})})}),(0,i.jsx)(r.td,{children:"Boolean"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"true"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"includeEquals"})})}),(0,i.jsx)(r.td,{children:"Boolean"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"false"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"filter"})})}),(0,i.jsx)(r.td,{children:"Function"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"(key) => true"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"metadataEquals"})})}),(0,i.jsx)(r.td,{children:"Function"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"(srcMetadata, dstMetadata) => { ... }"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"batch"})})}),(0,i.jsx)(r.td,{children:"Boolean"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"false"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"entries"})})}),(0,i.jsx)(r.td,{children:"Array"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"null"})})]})]})]}),"\n",(0,i.jsx)(r.h4,{id:"mirrorcount",children:(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"mirror.count"})})}),"\n",(0,i.jsx)(r.p,{children:"It counts the total files processed, added, removed, and changed."}),"\n",(0,i.jsxs)(r.p,{children:["Default: ",(0,i.jsx)(r.code,{children:"{ files: 0, add: 0, remove: 0, change: 0 }"})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",children:"const mirror = new MirrorDrive(src, dst)\nconsole.log(mirror.count) // => { files: 0, add: 0, remove: 0, change: 0 }\n"})}),"\n",(0,i.jsx)(r.h4,{id:"await-mirrordone",children:(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"await mirror.done()"})})}),"\n",(0,i.jsx)(r.p,{children:"It starts processing all the diffing until it is done."}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",children:"const mirror = new MirrorDrive(src, dst)\nawait mirror.done()\nconsole.log(mirror.count) // => { files: 1, add: 1, remove: 0, change: 0 }\n"})})]})}function h(e={}){const{wrapper:r}={...(0,d.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>c,x:()=>o});var s=n(6540);const i={},d=s.createContext(i);function c(e){const r=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(d.Provider,{value:r},e.children)}}}]);