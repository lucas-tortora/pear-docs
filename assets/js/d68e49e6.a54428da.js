"use strict";(globalThis.webpackChunkpear_docs_docusarus=globalThis.webpackChunkpear_docs_docusarus||[]).push([[9688],{2203:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"getting-started/release","title":"Releasing a Pear Application","description":"Pear applications are stored in an append-only log (hypercore).","source":"@site/docs/getting-started/release.md","sourceDirName":"getting-started","slug":"/getting-started/release","permalink":"/pear-docs/getting-started/release","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/getting-started/release.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Starting a Pear Desktop Project","permalink":"/pear-docs/getting-started/desktop/simple-chat-app"},"next":{"title":"Sharing a Pear Application","permalink":"/pear-docs/getting-started/share"}}');var t=a(4848),i=a(8453);const s={},l="Releasing a Pear Application",d={},o=[{value:"Step 1: Staging Production",id:"step-1-staging-production",level:2},{value:"Step 2: Marking a Release",id:"step-2-marking-a-release",level:2},{value:"Step 3: Running staged from a released app",id:"step-3-running-staged-from-a-released-app",level:2},{value:"Discussion",id:"discussion",level:2},{value:"The dump-stage-release strategy",id:"the-dump-stage-release-strategy",level:3},{value:"Distribution Packages",id:"distribution-packages",level:3},{value:"Next",id:"next",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"releasing-a-pear-application",children:"Releasing a Pear Application"})}),"\n",(0,t.jsxs)(n.p,{children:["Pear applications are stored in an append-only log (",(0,t.jsx)(n.a,{href:"../building-blocks/hypercore.md",children:"hypercore"}),")."]}),"\n",(0,t.jsxs)(n.p,{children:["Each version is identified by ",(0,t.jsx)(n.code,{children:"<fork>.<length>.<key>"}),". The length corresponds to the length of the application's append-only log at the time."]}),"\n",(0,t.jsx)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/OTwY_avUPyI?si=cPLGJGvWNzzvCv-z",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:!0}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"pear run <link>"})," opens the application."]}),"\n",(0,t.jsx)(n.p,{children:"Before a release has been marked, the latest version is used. This is useful during development, to test the app locally and to share a preview with other peers."}),"\n",(0,t.jsxs)(n.p,{children:["Once a release has been marked, ",(0,t.jsx)(n.code,{children:"pear run <link>"})," opens the latest marked release."]}),"\n",(0,t.jsx)(n.h2,{id:"step-1-staging-production",children:"Step 1: Staging Production"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"pear stage <channel name>"})," derives an application key from the channel name and the application name (as defined in the project's ",(0,t.jsx)(n.code,{children:"package.json"}),")."]}),"\n",(0,t.jsxs)(n.p,{children:["For example, a ",(0,t.jsx)(n.code,{children:"pear stage dev"})," release channel used during development can be complemented with a ",(0,t.jsx)(n.code,{children:"production"})," channel:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"pear stage production\n"})}),"\n",(0,t.jsx)(n.p,{children:"Running this command in a Pear project folder outputs an application link."}),"\n",(0,t.jsx)(n.p,{children:"Using separate channels for development and production means there is an application link for trusted peers and one for public peers."}),"\n",(0,t.jsxs)(n.p,{children:["The development link can remain unreleased, so that ",(0,t.jsx)(n.code,{children:"pear run <dev link>"})," loads the latest staged changes by default."]}),"\n",(0,t.jsxs)(n.p,{children:["The production link's releases can be marked, so that ",(0,t.jsx)(n.code,{children:"pear run <production link>"})," loads the latest stable release by default."]}),"\n",(0,t.jsx)(n.h2,{id:"step-2-marking-a-release",children:"Step 2: Marking a Release"}),"\n",(0,t.jsx)(n.p,{children:"Create a new release point with the latest staged changes on the production channel by running."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"pear release production\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Run ",(0,t.jsx)(n.code,{children:"pear help release"})," for more info on the command."]}),"\n",(0,t.jsx)(n.p,{children:"Keep in mind that changes to an application can only propagate to peers when the application is being seeded:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"pear seed production\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-3-running-staged-from-a-released-app",children:"Step 3: Running staged from a released app"}),"\n",(0,t.jsxs)(n.p,{children:["After marking a release, make a trivial change to the project (e.g. add a ",(0,t.jsx)(n.code,{children:"console.log(...)"})," somewhere)."]}),"\n",(0,t.jsxs)(n.p,{children:["First verify that it works by running ",(0,t.jsx)(n.code,{children:"pear run --dev ."})]}),"\n",(0,t.jsxs)(n.p,{children:["Now stage the change with ",(0,t.jsx)(n.code,{children:"pear stage production"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Opening the application with ",(0,t.jsx)(n.code,{children:"pear run <link>"})," will ",(0,t.jsx)(n.strong,{children:"not"})," output the log, because it loads the latest ",(0,t.jsx)(n.strong,{children:"marked"})," release."]}),"\n",(0,t.jsxs)(n.p,{children:["The latest staged changes of a released application can be previewed with the ",(0,t.jsx)(n.code,{children:"--checkout"})," flag:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"pear run --checkout=staged <link>\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The value of the ",(0,t.jsx)(n.code,{children:"--checkout"})," flag may be ",(0,t.jsx)(n.code,{children:"staged"}),", ",(0,t.jsx)(n.code,{children:"released"})," (the default) or a number referring to a specific version length."]}),"\n",(0,t.jsx)(n.h2,{id:"discussion",children:"Discussion"}),"\n",(0,t.jsx)(n.h3,{id:"the-dump-stage-release-strategy",children:"The dump-stage-release strategy"}),"\n",(0,t.jsx)(n.p,{children:"A development application link can be shared among trusted peers. At that point, it could be referred to as an internal application link (internal to the group of peers who have the link)."}),"\n",(0,t.jsxs)(n.p,{children:["While using different channel names is sensible, using ",(0,t.jsx)(n.code,{children:"pear stage dev"})," and ",(0,t.jsx)(n.code,{children:"pear stage production"})," on the same machine has practical implications."]}),"\n",(0,t.jsx)(n.p,{children:"A dump-stage-release strategy separates the concerns between development and production, by using a different machine for each."}),"\n",(0,t.jsx)(n.p,{children:"On the machine that holds the production link, run:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"pear dump <internal-link> <path-to-app-production-dir>\n"})}),"\n",(0,t.jsx)(n.p,{children:"This is a reverse stage: it synchronizes the application files to disk."}),"\n",(0,t.jsx)(n.p,{children:"Once complete, the project can be staged from the production machine with:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"pear stage production\n"})}),"\n",(0,t.jsx)(n.p,{children:"Then released with:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"pear release production\n"})}),"\n",(0,t.jsxs)(n.p,{children:["To allow other peers access to the new release, run ",(0,t.jsx)(n.code,{children:"pear seed production"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"distribution-packages",children:"Distribution Packages"}),"\n",(0,t.jsx)(n.p,{children:"Asset building of distribution packages (.dmg, .msi, .appimage) is not yet possible with Pear, but will be supported in the future."}),"\n",(0,t.jsx)(n.h2,{id:"next",children:"Next"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"./starting-a-pear-desktop-project.md",children:"Starting a Pear Desktop Project"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"./making-a-pear-desktop-app.md",children:"Making a Pear Desktop Application"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"./starting-a-pear-terminal-project.md",children:"Starting a Pear Terminal Project"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"./making-a-pear-terminal-app.md",children:"Making a Pear Terminal Application"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"./sharing-a-pear-app.md",children:"Sharing a Pear Application"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>l});var r=a(6540);const t={},i=r.createContext(t);function s(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);